<!DOCTYPE html>
<html>
<head>
<title>Grocery Shop - Admin</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Arial;background:#f5f5f5;}
.header{background:#e60000;color:white;padding:15px;text-align:center;}
.header h2{margin:0;}
.main{padding:20px;}
input,select,button{padding:8px;margin:5px;font-size:16px;}
button{cursor:pointer;border:none;border-radius:5px;background:#ffcc00;transition:0.3s;}
button:hover{background:#ffdb4d;}
.products, .orders{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:20px;margin-top:20px;}
.card{background:white;padding:10px;text-align:center;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,0.1);}
.card img{width:100%;height:120px;object-fit:cover;border-radius:5px;}
</style>
</head>
<body>

<div class="header"><h2>Admin Panel - Grocery Shop</h2></div>
<div class="main">

<h3>Add Product</h3>
<input type="text" id="productName" placeholder="Product Name">
<input type="text" id="productCategory" placeholder="Category">
<input type="number" id="productPrice" placeholder="Price">
<input type="text" id="productImageURL" placeholder="Image URL">
<button onclick="addProduct()">Add Product</button>

<h3>Existing Products</h3>
<div class="products" id="productList"></div>

<h3>Orders</h3>
<div class="orders" id="orderList"></div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyCkYMVn0Jh4Oo8Mgm8WyVAOVe65lSLGeks",
  authDomain: "barrahms-app.firebaseapp.com",
  projectId: "barrahms-app",
  storageBucket: "barrahms-app.appspot.com",
  messagingSenderId: "886499355529",
  appId: "1:886499355529:web:7b6f08565c23f980b5cf58"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

// Add Product
function addProduct(){
  const name=document.getElementById("productName").value.trim();
  const category=document.getElementById("productCategory").value.trim();
  const price=parseFloat(document.getElementById("productPrice").value);
  const imageURL=document.getElementById("productImageURL").value.trim();
  if(!name||!category||!price||!imageURL){alert("All fields required!");return;}
  db.collection("products").add({name,category,price,imageURL})
  .then(()=>{alert("Product added!");loadProducts();})
  .catch(err=>alert(err.message));
}

// Load Products
function loadProducts(){
  const list=document.getElementById("productList");
  list.innerHTML='';
  db.collection("products").get().then(snapshot=>{
    snapshot.forEach(doc=>{
      const data=doc.data();
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`<img src="${data.imageURL}"><h4>${data.name}</h4>
      <p>${data.category}</p><p>${data.price} à§³</p>
      <button onclick="deleteProduct('${doc.id}')">Delete</button>`;
      list.appendChild(card);
    });
  });
}
function deleteProduct(id){db.collection("products").doc(id).delete().then(()=>loadProducts()).catch(err=>alert(err));}
loadProducts();

// Load Orders
function loadOrders(){
  const list=document.getElementById("orderList");
  list.innerHTML='';
  db.collection("orders").orderBy("time","desc").get().then(snapshot=>{
    snapshot.forEach(doc=>{
      const data=doc.data();
      const card=document.createElement("div");
      card.className="card";
      card.innerHTML=`<h4>${data.name}</h4>
      <p>Phone: ${data.phone}</p>
      <p>Address: ${data.address}</p>
      <p>Product: ${data.product}</p>
      <p>Status: ${data.status || 'Pending'}</p>
      <button onclick="confirmOrder('${doc.id}','${data.phone}')">Confirm</button>
      <button onclick="deleteOrder('${doc.id}','${data.phone}')">Delete</button>`;
      list.appendChild(card);
    });
  });
}

function confirmOrder(id,phone){
  db.collection("orders").doc(id).update({status:'Confirmed'})
  .then(()=>{alert('Order confirmed for '+phone);loadOrders();});
}
function deleteOrder(id,phone){
  db.collection("orders").doc(id).delete()
  .then(()=>{alert('Order cancelled for '+phone);loadOrders();});
}
loadOrders();
</script>
</body>
</html>
